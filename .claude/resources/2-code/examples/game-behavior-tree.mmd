---
title: AI Behavior Trees
---
graph TD
    %% Enemy AI Behavior Tree
    Root[Root Selector]

    %% High Priority: Survival
    CheckHealth{Check Health}
    LowHealth{HP < 30%?}
    Flee[Flee from Player]
    FindHealth[Find Health Pack]

    %% Medium Priority: Combat
    PlayerDetected{Player Detected?}
    InRange{In Attack Range?}
    HasLineOfSight{Has Line of Sight?}
    Attack[Execute Attack]
    MoveToPlayer[Move Towards Player]
    TakeCover[Move to Cover]

    %% Low Priority: Patrol
    PatrolSequence[Patrol Sequence]
    HasWaypoints{Has Waypoints?}
    MoveToWaypoint[Move to Next Waypoint]
    WaitAtWaypoint[Wait at Waypoint]
    LookAround[Scan for Threats]

    %% Idle Behavior
    IdleSequence[Idle Sequence]
    PlayIdleAnimation[Play Idle Animation]
    RandomLook[Random Look Around]

    %% Tree Structure
    Root --> CheckHealth
    CheckHealth --> LowHealth
    LowHealth -->|Yes| Flee
    LowHealth -->|No| PlayerDetected
    Flee --> FindHealth

    PlayerDetected -->|Yes| InRange
    PlayerDetected -->|No| PatrolSequence

    InRange -->|Yes| HasLineOfSight
    InRange -->|No| MoveToPlayer

    HasLineOfSight -->|Yes| Attack
    HasLineOfSight -->|No| TakeCover

    PatrolSequence --> HasWaypoints
    HasWaypoints -->|Yes| MoveToWaypoint
    HasWaypoints -->|No| IdleSequence
    MoveToWaypoint --> WaitAtWaypoint
    WaitAtWaypoint --> LookAround

    IdleSequence --> PlayIdleAnimation
    PlayIdleAnimation --> RandomLook

    %% Boss Behavior Tree
    BossRoot[Boss Root Selector]

    %% Phase Check
    CheckPhase{Check Current Phase}
    Phase1Tree[Phase 1 Behavior]
    Phase2Tree[Phase 2 Behavior]
    Phase3Tree[Phase 3 Behavior]

    %% Phase 1 (100-75% HP)
    P1Attack1[Basic Melee Attack]
    P1Attack2[Ground Slam]
    P1Cooldown[Wait 3s]

    %% Phase 2 (75-50% HP)
    P2SummonMinions[Summon Minions]
    P2RangedAttack[Fire Projectiles]
    P2AreaAttack[AOE Attack]
    P2Cooldown[Wait 2s]

    %% Phase 3 (50-0% HP)
    P3EnrageCheck{Is Enraged?}
    P3Enrage[Activate Enrage Mode]
    P3UltimateAttack[Ultimate Ability]
    P3ComboAttack[Combo Attack Chain]
    P3Teleport[Teleport Behind Player]

    BossRoot --> CheckPhase
    CheckPhase -->|Phase 1| Phase1Tree
    CheckPhase -->|Phase 2| Phase2Tree
    CheckPhase -->|Phase 3| Phase3Tree

    Phase1Tree --> P1Attack1
    P1Attack1 --> P1Attack2
    P1Attack2 --> P1Cooldown

    Phase2Tree --> P2SummonMinions
    P2SummonMinions --> P2RangedAttack
    P2RangedAttack --> P2AreaAttack
    P2AreaAttack --> P2Cooldown

    Phase3Tree --> P3EnrageCheck
    P3EnrageCheck -->|No| P3Enrage
    P3EnrageCheck -->|Yes| P3UltimateAttack
    P3Enrage --> P3ComboAttack
    P3UltimateAttack --> P3Teleport
    P3ComboAttack --> P3Teleport

    %% Guard AI Behavior Tree
    GuardRoot[Guard Root Selector]

    %% Alert Check
    AlertLevel{Alert Level?}
    SuspiciousNoise[Investigate Noise]
    ReturnToPost[Return to Guard Post]

    %% Combat Check
    ThreatDetected{Threat Detected?}
    CallBackup[Call for Backup]
    EngageCombat[Engage in Combat]

    %% Patrol Duty
    GuardPatrol[Guard Patrol Routine]
    CheckPost[Check Guard Post]
    ScanArea[Scan Surrounding Area]

    GuardRoot --> AlertLevel
    AlertLevel -->|High| ThreatDetected
    AlertLevel -->|Medium| SuspiciousNoise
    AlertLevel -->|Low| GuardPatrol

    ThreatDetected -->|Yes| CallBackup
    ThreatDetected -->|No| ReturnToPost
    CallBackup --> EngageCombat

    SuspiciousNoise --> ScanArea
    ScanArea --> ReturnToPost

    GuardPatrol --> CheckPost
    CheckPost --> ScanArea

    %% Companion AI Behavior Tree
    CompanionRoot[Companion Root Selector]

    %% Following Player
    PlayerDistance{Distance to Player}
    TooFar[Run to Player]
    FollowNormal[Walk Behind Player]
    TooClose[Stop and Wait]

    %% Combat Support
    PlayerInCombat{Player Fighting?}
    EnemiesNearby{Enemies Nearby?}
    AssistPlayer[Attack Enemy]
    BuffPlayer[Apply Support Buff]

    %% Item Assistance
    LowPlayerHealth{Player HP < 50%?}
    HasHealthItem{Has Health Item?}
    GiveHealth[Give Health to Player]

    CompanionRoot --> PlayerInCombat
    PlayerInCombat -->|Yes| EnemiesNearby
    PlayerInCombat -->|No| LowPlayerHealth

    EnemiesNearby -->|Yes| AssistPlayer
    EnemiesNearby -->|No| BuffPlayer

    LowPlayerHealth -->|Yes| HasHealthItem
    LowPlayerHealth -->|No| PlayerDistance

    HasHealthItem -->|Yes| GiveHealth
    HasHealthItem -->|No| PlayerDistance

    PlayerDistance -->|> 10m| TooFar
    PlayerDistance -->|3-10m| FollowNormal
    PlayerDistance -->|< 3m| TooClose

    %% Styling
    classDef selector fill:#3B82F6,stroke:#1E40AF,color:#fff
    classDef sequence fill:#10B981,stroke:#059669,color:#fff
    classDef condition fill:#F59E0B,stroke:#D97706,color:#fff
    classDef action fill:#8B5CF6,stroke:#6D28D9,color:#fff
    classDef decorator fill:#EC4899,stroke:#DB2777,color:#fff

    class Root,BossRoot,GuardRoot,CompanionRoot selector
    class PatrolSequence,IdleSequence,Phase1Tree,Phase2Tree,Phase3Tree,GuardPatrol sequence
    class CheckHealth,LowHealth,PlayerDetected,InRange,HasLineOfSight,HasWaypoints,CheckPhase,P3EnrageCheck,AlertLevel,ThreatDetected,PlayerDistance,PlayerInCombat,EnemiesNearby,LowPlayerHealth,HasHealthItem condition
    class Flee,FindHealth,Attack,MoveToPlayer,TakeCover,MoveToWaypoint,WaitAtWaypoint,LookAround,PlayIdleAnimation,RandomLook,P1Attack1,P1Attack2,P1Cooldown,P2SummonMinions,P2RangedAttack,P2AreaAttack,P2Cooldown,P3Enrage,P3UltimateAttack,P3ComboAttack,P3Teleport,SuspiciousNoise,ReturnToPost,CallBackup,EngageCombat,CheckPost,ScanArea,TooFar,FollowNormal,TooClose,AssistPlayer,BuffPlayer,GiveHealth action

%% Behavior Tree Node Types:
%%
%% Selector (Blue): Try children left-to-right until one succeeds
%% Sequence (Green): Execute children in order, fail if any fails
%% Condition (Orange): Check/decision node, returns true/false
%% Action (Purple): Execute specific behavior
%% Decorator (Pink): Modify child behavior (repeat, invert, etc.)
%%
%% Enemy AI:
%% - Priority: Survival > Combat > Patrol > Idle
%% - Flees when health is low
%% - Attacks when player detected and in range
%% - Patrols when no threats
%% - Idles when no patrol route
%%
%% Boss AI:
%% - Phase-based behavior
%% - Each phase unlocks new attacks
%% - Enrage mechanic in Phase 3
%% - Complexity increases with damage taken
%%
%% Guard AI:
%% - Alert-level based behavior
%% - Investigates suspicious activity
%% - Calls for backup when threatened
%% - Returns to post when clear
%%
%% Companion AI:
%% - Follows player at appropriate distance
%% - Assists in combat
%% - Provides support (healing, buffs)
%% - Manages inventory for player

%% Generated: 2025-10-31
%% Auto-updated by /2-code skill
