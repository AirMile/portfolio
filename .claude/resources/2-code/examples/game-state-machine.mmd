---
title: Game State Machines
---
stateDiagram-v2
    [*] --> GameStart

    %% Game State Machine
    state "Game States" as GameStates {
        GameStart --> MainMenu
        MainMenu --> Playing : Start Game
        MainMenu --> Settings : Open Settings
        MainMenu --> Quit : Exit Game

        Settings --> MainMenu : Back

        Playing --> Paused : Press ESC
        Playing --> GameOver : Player Dies
        Playing --> Victory : Level Complete

        Paused --> Playing : Resume
        Paused --> MainMenu : Quit to Menu

        GameOver --> MainMenu : Return
        GameOver --> Playing : Retry

        Victory --> Playing : Next Level
        Victory --> MainMenu : Return
    }

    %% Enemy AI State Machine
    state "Enemy AI States" as EnemyStates {
        [*] --> Idle

        Idle --> Patrol : Start Patrolling
        Idle --> Idle : No Target

        Patrol --> Chase : Player Detected
        Patrol --> Patrol : Continue Route
        Patrol --> Idle : Route Complete

        Chase --> Attack : In Range
        Chase --> Patrol : Lost Player
        Chase --> Chase : Following

        Attack --> Chase : Out of Range
        Attack --> Attack : Still in Range
        Attack --> Dead : Health <= 0

        Dead --> [*]
    }

    %% Player State Machine
    state "Player States" as PlayerStates {
        [*] --> Idle_Player

        Idle_Player --> Walking : Move Input
        Idle_Player --> Jumping : Jump Input
        Idle_Player --> Attacking : Attack Input

        Walking --> Idle_Player : No Input
        Walking --> Running : Sprint Input
        Walking --> Jumping : Jump Input
        Walking --> Attacking : Attack Input

        Running --> Walking : Release Sprint
        Running --> Jumping : Jump Input

        Jumping --> Falling : Apex Reached
        Falling --> Landing : Touch Ground
        Landing --> Idle_Player : Animation Complete

        Attacking --> Idle_Player : Attack Complete
        Attacking --> ComboAttack : Attack Input (timing)

        ComboAttack --> Idle_Player : Combo Complete

        Idle_Player --> Dead_Player : Health <= 0
        Walking --> Dead_Player : Health <= 0
        Running --> Dead_Player : Health <= 0
        Jumping --> Dead_Player : Health <= 0
        Attacking --> Dead_Player : Health <= 0

        Dead_Player --> [*] : Respawn
    }

    %% Boss State Machine
    state "Boss AI States" as BossStates {
        [*] --> Intro

        Intro --> Phase1 : Intro Complete

        state "Phase 1 (100-75% HP)" as Phase1 {
            [*] --> BasicAttack1
            BasicAttack1 --> GroundSlam
            GroundSlam --> Cooldown1
            Cooldown1 --> BasicAttack1
        }

        Phase1 --> Transition1 : HP <= 75%

        Transition1 --> Phase2 : Transition Complete

        state "Phase 2 (75-50% HP)" as Phase2 {
            [*] --> BasicAttack2
            BasicAttack2 --> GroundSlam
            GroundSlam --> FireBreath
            FireBreath --> Cooldown2
            Cooldown2 --> BasicAttack2
        }

        Phase2 --> Transition2 : HP <= 50%

        Transition2 --> Phase3 : Transition Complete

        state "Phase 3 (50-25% HP)" as Phase3 {
            [*] --> RageMode
            RageMode --> ComboAttack_Boss
            ComboAttack_Boss --> AreaAttack
            AreaAttack --> SummonMinions
            SummonMinions --> Cooldown3
            Cooldown3 --> RageMode
        }

        Phase3 --> Transition3 : HP <= 25%

        Transition3 --> FinalPhase : Transition Complete

        state "Final Phase (25-0% HP)" as FinalPhase {
            [*] --> Enraged
            Enraged --> UltimateAbility
            UltimateAbility --> AllOutAttack
            AllOutAttack --> Enraged
        }

        FinalPhase --> Defeated : HP <= 0
        Defeated --> [*]
    }

    %% Quest State Machine
    state "Quest States" as QuestStates {
        [*] --> NotStarted

        NotStarted --> Active : Accept Quest
        Active --> InProgress : Start Objective
        InProgress --> InProgress : Progress Update
        InProgress --> Completed : All Objectives Done
        InProgress --> Failed : Fail Condition
        Completed --> Rewarded : Turn In
        Failed --> Active : Retry (if allowed)
        Rewarded --> [*]
    }

    %% Item Interaction State Machine
    state "Item Interaction" as ItemStates {
        [*] --> NotInteractable

        NotInteractable --> InRange : Player Near
        InRange --> NotInteractable : Player Leaves
        InRange --> Highlighting : Show Prompt
        Highlighting --> PickingUp : Interact
        PickingUp --> InventoryCheck

        state InventoryCheck <<choice>>
        InventoryCheck --> AddedToInventory : Has Space
        InventoryCheck --> InventoryFull : No Space

        AddedToInventory --> [*]
        InventoryFull --> InRange : Return
    }

%% State Machine Descriptions:
%%
%% Game States:
%% - Controls overall game flow
%% - Handles menu navigation and game states
%%
%% Enemy AI States:
%% - Idle: Standing still, scanning for player
%% - Patrol: Following waypoint route
%% - Chase: Pursuing detected player
%% - Attack: In range, executing attacks
%% - Dead: Death animation, drop loot
%%
%% Player States:
%% - Movement states (Idle, Walking, Running)
%% - Aerial states (Jumping, Falling, Landing)
%% - Combat states (Attacking, Combo)
%% - Death state
%%
%% Boss States:
%% - Multiple phases based on HP thresholds
%% - Each phase unlocks new attack patterns
%% - Transitions between phases
%% - Enrage mechanic in final phase
%%
%% Quest States:
%% - Track quest progression
%% - Handle completion and failures
%% - Reward distribution
%%
%% Item Interaction:
%% - Proximity detection
%% - Visual feedback
%% - Inventory validation

%% Generated: 2025-10-31
%% Auto-updated by /2-code skill
